# **任务五——行人跟踪检测**

# 一、目标检测

## 1、内容
目标检测任务是找出图像或视频中人们感兴趣的物体，并同时检测出它们的位置和大小。不同于图像分类任务，目标检测不仅要解决分类问题，还要解决定位问题，是属于Multi-Task的问题。

## 2、目标检测算法的发展
目标检测的发展脉络可以划分为两个周期：传统目标检测算法时期(1998年-2014年)和基于深度学习的目标检测算法时期(2014年-至今)。而基于深度学习的目标检测算法又发展成了两条技术路线：**Anchor based**方法和**Anchor free**方法。

### 2.1、传统目标检测算法
不同于现在的卷积神经网络可以自动提取高效特征进行图像表示，以往的传统目标检测算法主要基于手工提取特征。传统检测算法流程可概括如下：
1.  选取感兴趣区域，选取可能包含物体的区域
2.  对可能包含物体的区域进行特征提取
3.  对提取的特征进行检测分类

基于手工提取特征的传统目标检测算法主要有以下三个缺点：
1.  识别效果不够好，准确率不高
2.  计算量较大，运算速度慢
3.  可能产生多个正确识别的结果

### 2.2、Anchor-Based二阶段目标检测算法
基于手工提取特征的传统目标检测算法进展缓慢，性能低下。直到2012年卷积神经网络的兴起将目标检测领域推向了新的台阶。基于CNNs的目标检测算法主要有两条技术发展路线：anchor-based和anchor-free方法，而anchor-based方法则包括一阶段和二阶段检测算法。二阶段目标检测算法一般比一阶段精度要高，但一阶段检测算法速度会更快。

二阶段检测算法主要分为以下两个阶段
1. 从图像中生成区域推荐
2. 从区域推荐生成最终的物体边框

#### RCNN算法
RCNN通过选择性搜索算法从一组对象候选框中选择可能出现的对象框，并喂入到CNN模型提取特征，最后将提取出的特征送入到SVM分类器来预测该对象框中的图像是否存在待检测目标，并进一步预测该检测目标具体属于哪一类。

RCNN算法取得了非常显著的效果，平均精度提升到58.5%。相比于传统检测算法，基于深度学习的检测算法在精度上取得了质的飞跃。
虽然RCNN算法取得了很大进展，但缺点也很明显：重叠框(一张图片大约2000多个候选框)特征的冗余计算使得整个网络的检测速度变得很慢(使用GPU的情况下检测一张图片大约需要14S)。

### 2.3、Anchor-based一阶段目标检测算法
一阶段目标检测算法不需要区域推荐阶段，直接产生物体的类别概率和位置坐标值，经过一个阶段即可直接得到最终的检测结果，因此有着更快的检测速度。

#### YOLO v1
YOLO v1是第一个一阶段的深度学习检测算法，其检测速度非常快，该算法的思想就是将图像划分成多个网格，然后为每一个网格同时预测边界框并给出相应概率。例如某个待检测目标的中心落在图像中所划分的一个单元格内，那么该单元格负责预测该目标位置和类别。

YOLO v1检测速度非常快。相比于二阶段的目标检测算法，尽管YOLO v1算法的检测速度有了很大提高，但精度相对教低(尤其是对于一些小目标检测问题)。

#### SSD
SSD算法的主要创新点是提出了Multi-reference和Multi-resolution的检测技术。SSD算法和先前的一些检测算法的区别在于：先前的一些检测算法只是在网络最深层的分支进行检测，而SSD有多个不同的检测分支，不同的检测分支可以检测多个尺度的目标，所以SSD在多尺度目标检测的精度上有了很大的提高，对小目标检测效果要好很多。

相比于YOLO v1算法，SSD进一步提高了检测精度和速度。

## 3、行人检测

### 行人检测任务中存在的难点与挑战可简要概括为如下四点
1.  小尺寸行人  
    在Caltech数据集中，据统计大约15%的行人其高度都小于30个像素点。  
2.  困难负样本  
    由于场景图像中一些背景在视觉上与行人非常相似，这导致网络很难将负样本进行正确分类，往往会将一些很像行人的背景物体预测成为行人。  
3.  行人密集且遮挡情况  
   由于图像中多存在行人密集且行人遮挡情况，这导致网络难以精准检测出被遮挡的行人，在Caltech数据集中，据统计行人未遮挡的个体约占行人总数的29%。  
4.  固有的实时检测性能  
    由于一些自动驾驶和视频监控等应用需要检测算法能够实时提供检测结果以便系统快速做出决断，因此视频的实时行人检测至关重要。  

### 解决方法
1.  改善小尺寸行人检测  
    即使Fast/Faster RCNN算法在当时表现SOTA，但由于检测头所提取出的低分辨率特征，导致它对小目标的检测效果并不理想。近年来针对这个问题的一些解决方案包括：1)特征融合，2)引入超高分辨率手工提取的特征，3)在多个分辨率特征图上集成检测结果。  
2.  改善困难负样本检测  
    近年来对于改善困难负样本的检测方法主要有：决策树增强和语义分割(作为一种上下文信息引入)，此外，还引入了跨模态学习的思想，通过使用RGB和红外图像的方式来丰富困难负样本的特征。  
3.  改善行人密集且遮挡的检测  
    CNN中深层的特征具有更丰富的语义信息，但对密集物体的检测是无效的，为此一些研究学者通过考虑目标的吸引和目标周围背景的排斥关系，设计了一种新的损失函数。而目标遮挡则是伴随行人密集所出现的另一个问题，部分检测器的集成和注意力机制是解决行人遮挡问题最常见的方法。

# 二、目标跟踪

## 1、与目标检测对比

### 1.1、区别
* 目标检测就是检测出一个图片或者一个视频中目标的位置，如yolo检测目标。
* 目标追踪是给视频中第一帧目标以及它的位置，然后跟踪这个目标，以及预测它的轨迹。如果出现一些遮挡，也可以根据轨迹来跟踪这个目标。有时候还会出现丢帧的情况，如果用了跟踪算法，那么即使丢帧了，也可以跟住目标而不丢失。目标检测虽然给定了目标的位置，但是很难求出它们的轨迹。

目标检测和跟踪的区别在于对于运动中变化目标的跟踪能力。理想的跟踪器应该不需要每一帧都暴力检测目标所在的位置，而是可以充分利用帧间信息，目标周围的环境信息，甚至根据周边环境推测得到的三维信息等，更加高效的确定目标所在的位置。
目标检测和跟踪的区别还应在于对于相同目标不同实例的跟踪能力。比如目标检测器可以检测到马路上的大量行人，但是无法只检测某个一个特定的人。而跟踪器可以初始化为跟踪行人，但在给跟踪器指定初始跟踪行人后，它将可以在后续的过程中只跟踪指定的行人。

### 1.2、联系
* 跟踪是基于检测的，必须先定位目标，才能后续跟踪。
* 如果将动态的检测(例如视频序列检测)分割成一定时间段内的静态检测(每一帧)，那么用检测是可以实现类似跟踪的效果(伪跟踪,因为其实还是每一帧做检测)。
* 现在很多的跟踪算法是基于检测的，使得他们间联系更密切

## 2、行人跟踪的难点
-   **形态变化** - 姿态变化是目标跟踪中常见的干扰问题。运动目标发生姿态变化时, 会导致它的特征以及外观模型发生改变, 容易导致跟踪失败。
-   **尺度变化** - 尺度的自适应也是目标跟踪中的关键问题。当目标尺度缩小时, 由于跟踪框不能自适应跟踪, 会将很多背景信息包含在内, 导致目标模型的更新错误；当目标尺度增大时, 由于跟踪框不能将目标完全包括在内, 跟踪框内目标信息不全, 也会导致目标模型的更新错误。
-   **遮挡与消失** - 目标在运动过程中可能出现被遮挡或者短暂的消失情况。当这种情况发生时, 跟踪框容易将遮挡物以及背景信息包含在跟踪框内, 会导致后续帧中的跟踪目标漂移到遮挡物上面。若目标被完全遮挡时, 由于找不到目标的对应模型, 会导致跟踪失败。
-   **图像模糊** - 光照强度变化, 目标快速运动, 低分辨率等情况会导致图像模型, 尤其是在运动目标与背景相似的情况下更为明显。因此, 选择有效的特征对目标和背景进行区分非常必要。

## 3、目标跟踪方法

### 生成式模型
早期的工作主要集中于生成式模型跟踪算法的研究，如光流法、粒子滤波、Meanshift算法、Camshift算法等。此类方法首先建立目标模型或者提取目标特征，在后续帧中进行相似特征搜索。逐步迭代实现目标定位。但是这类方法也存在明显的缺点，就是图像的背景信息没有得到全面的利用。且目标本身的外观变化有随机性和多样性特点，通过单一的数学模型描述待跟踪目标具有很大的局限性。

### 鉴别式模型
鉴别式模型是指将目标模型和背景信息同时考虑在内，通过对比目标模型和背景信息的差异，将目标模型提取出来，从而得到当前帧中的目标位置。在对跟踪算法的评估中发现，通过将背景信息引入跟踪模型，可以很好地实现目标跟踪。因此鉴别式模型具有很大的优势。

## 4、目标跟踪算法的发展

### 经典跟踪算法
早期的目标跟踪算法主要是根据目标建模或者对目标特征进行跟踪。
1. 基于目标模型：通过对目标外观模型进行建模， 然后在之后的帧中找到目标。最常用的是特征匹配法，首先提取目标特征，然后在后续的帧中找到最相似的特征进行目标定位。
2. 基于搜索的方法：随着研究的深入, 人们发现基于目标模型建模的方法对整张图片进行处理，实时性差。人们将预测算法加入跟踪中，在预测值附近进行目标搜索，减少了搜索的范围。

### 基于核相关滤波的跟踪算法
人们将通信领域的相关滤波(衡量两个信号的相似程度)引入到了目标跟踪中。基本思想：越是相似的两个目标相关值越大，也就是视频帧中与初始化目标越相似，得到的相应也就越大。

### 基于深度学习的跟踪算法
在大数据背景下，利用深度学习训练网络模型，得到的卷积特征输出表达能力更强。在目标跟踪上，初期的应用方式是把网络学习到的特征，直接应用到相关滤波或跟踪框架里面，从而得到更好的跟踪结果。

# 三、主要参考资料
https://baike.baidu.com/item/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/8688936?fr=aladdin
https://baike.baidu.com/item/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/2803351?fromModule=lemma-qiyi_sense-lemma
https://www.bilibili.com/video/BV1m5411A7FD?p=2&vd_source=6ca65fcecd1c1a33f1276368d62a8219
https://blog.csdn.net/Cai_deLong/article/details/108774996
https://zhuanlan.zhihu.com/p/148516834
https://www.bilibili.com/video/BV1XW4y1a7f4/?spm_id_from=333.337.search-card.all.click
https://zhuanlan.zhihu.com/p/523333637

from林宇浩21311274
